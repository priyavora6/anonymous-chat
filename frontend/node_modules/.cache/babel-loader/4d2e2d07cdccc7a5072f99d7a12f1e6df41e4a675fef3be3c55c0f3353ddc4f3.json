{"ast":null,"code":"export function createSocket(deviceId) {\n  const url = `ws://localhost:8000/ws?device_id=${deviceId}`;\n  let reconnectAttempts = 0;\n  const maxReconnectAttempts = 5;\n  const reconnectDelay = 3000; // 3 seconds\n\n  function connect() {\n    const ws = new WebSocket(url);\n    ws.addEventListener('open', () => {\n      console.log('ws open');\n      reconnectAttempts = 0; // Reset on successful connection\n    });\n    ws.addEventListener('close', () => {\n      console.log('ws closed');\n      // Auto-reconnect logic\n      if (reconnectAttempts < maxReconnectAttempts) {\n        reconnectAttempts++;\n        console.log(`Attempting to reconnect... (${reconnectAttempts}/${maxReconnectAttempts})`);\n        setTimeout(() => {\n          const newWs = connect();\n          // Copy event handlers to new socket\n          Object.assign(ws, newWs);\n        }, reconnectDelay);\n      } else {\n        console.error('Max reconnection attempts reached');\n      }\n    });\n    ws.addEventListener('error', e => console.error('ws error', e));\n    return ws;\n  }\n  return connect();\n}","map":{"version":3,"names":["createSocket","deviceId","url","reconnectAttempts","maxReconnectAttempts","reconnectDelay","connect","ws","WebSocket","addEventListener","console","log","setTimeout","newWs","Object","assign","error","e"],"sources":["D:/sem 6/anonymous-chat/frontend/src/utils/socket.js"],"sourcesContent":["export function createSocket(deviceId){\r\n  const url = `ws://localhost:8000/ws?device_id=${deviceId}`\r\n  let reconnectAttempts = 0\r\n  const maxReconnectAttempts = 5\r\n  const reconnectDelay = 3000 // 3 seconds\r\n  \r\n  function connect() {\r\n    const ws = new WebSocket(url)\r\n    \r\n    ws.addEventListener('open', () => {\r\n      console.log('ws open')\r\n      reconnectAttempts = 0 // Reset on successful connection\r\n    })\r\n    \r\n    ws.addEventListener('close', () => {\r\n      console.log('ws closed')\r\n      // Auto-reconnect logic\r\n      if (reconnectAttempts < maxReconnectAttempts) {\r\n        reconnectAttempts++\r\n        console.log(`Attempting to reconnect... (${reconnectAttempts}/${maxReconnectAttempts})`)\r\n        setTimeout(() => {\r\n          const newWs = connect()\r\n          // Copy event handlers to new socket\r\n          Object.assign(ws, newWs)\r\n        }, reconnectDelay)\r\n      } else {\r\n        console.error('Max reconnection attempts reached')\r\n      }\r\n    })\r\n    \r\n    ws.addEventListener('error', (e) => console.error('ws error', e))\r\n    \r\n    return ws\r\n  }\r\n  \r\n  return connect()\r\n}\r\n"],"mappings":"AAAA,OAAO,SAASA,YAAYA,CAACC,QAAQ,EAAC;EACpC,MAAMC,GAAG,GAAG,oCAAoCD,QAAQ,EAAE;EAC1D,IAAIE,iBAAiB,GAAG,CAAC;EACzB,MAAMC,oBAAoB,GAAG,CAAC;EAC9B,MAAMC,cAAc,GAAG,IAAI,EAAC;;EAE5B,SAASC,OAAOA,CAAA,EAAG;IACjB,MAAMC,EAAE,GAAG,IAAIC,SAAS,CAACN,GAAG,CAAC;IAE7BK,EAAE,CAACE,gBAAgB,CAAC,MAAM,EAAE,MAAM;MAChCC,OAAO,CAACC,GAAG,CAAC,SAAS,CAAC;MACtBR,iBAAiB,GAAG,CAAC,EAAC;IACxB,CAAC,CAAC;IAEFI,EAAE,CAACE,gBAAgB,CAAC,OAAO,EAAE,MAAM;MACjCC,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;MACxB;MACA,IAAIR,iBAAiB,GAAGC,oBAAoB,EAAE;QAC5CD,iBAAiB,EAAE;QACnBO,OAAO,CAACC,GAAG,CAAC,+BAA+BR,iBAAiB,IAAIC,oBAAoB,GAAG,CAAC;QACxFQ,UAAU,CAAC,MAAM;UACf,MAAMC,KAAK,GAAGP,OAAO,CAAC,CAAC;UACvB;UACAQ,MAAM,CAACC,MAAM,CAACR,EAAE,EAAEM,KAAK,CAAC;QAC1B,CAAC,EAAER,cAAc,CAAC;MACpB,CAAC,MAAM;QACLK,OAAO,CAACM,KAAK,CAAC,mCAAmC,CAAC;MACpD;IACF,CAAC,CAAC;IAEFT,EAAE,CAACE,gBAAgB,CAAC,OAAO,EAAGQ,CAAC,IAAKP,OAAO,CAACM,KAAK,CAAC,UAAU,EAAEC,CAAC,CAAC,CAAC;IAEjE,OAAOV,EAAE;EACX;EAEA,OAAOD,OAAO,CAAC,CAAC;AAClB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}